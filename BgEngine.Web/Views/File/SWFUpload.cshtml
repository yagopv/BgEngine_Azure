@*==============================================================================
 This file is part of BgEngine.

 BgEngine is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 BgEngine is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with BgEngine. If not, see <http://www.gnu.org/licenses/>.
==============================================================================
 Copyright (c) 2011 Yago Pérez Vázquez
 Version: 1.0
==============================================================================*@

@model BgEngine.Domain.EntityModel.Album
		   
<link href="@Url.Content("~/Content/swfupload.css")" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="@Url.Content("~/Scripts/swfupload.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/swfupload.queue.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/swfupload.fileprogress.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/swfupload.handlers.js")"></script>

<script type="text/javascript">

	function uploadSuccessForAlbum(file, serverData) {
		try {
			var progress = new FileProgress(file, this.customSettings.progressTarget);
			progress.setComplete();
			progress.setStatus("Complete.");
			progress.toggleCancel(false);
		} catch (ex) {
			this.debug(ex);
		}
		    $("#content").load("@Request.Path #content");
    }

	var swfu;
	window.onload = function () {
		var settings = {
			flash_url: "@Url.Content("~/Content/SWF/swfupload.swf")",
			flash9_url : "@Url.Content("~/Content/SWF/swfupload_fp9.swf")",
			upload_url: "@Url.RouteUrl("Default", new { controller = "File", action = "SWFUpload" })",
			post_params: { "PHPSESSID": "" },
			file_size_limit: "5 MB",
			file_types: "*.*",
			file_types_description: "All Files",
			file_upload_limit: 100,
			file_queue_limit: 0,
			custom_settings: {
				progressTarget: "fsUploadProgress",
				cancelButtonId: "btnCancel"
			},			
			debug: false,
			use_query_string:true,
			// Button settings
			button_width: "100",
			button_height: "30",
			button_placeholder_id: "spanButtonPlaceHolder",
			button_window_mode: SWFUpload.WINDOW_MODE.TRANSPARENT,
			button_cursor: SWFUpload.CURSOR.HAND,


			// The event handler functions are defined in handlers.js
			file_queued_handler: fileQueued,
			file_queue_error_handler: fileQueueError,
			file_dialog_complete_handler: fileDialogComplete,
			upload_start_handler: uploadStart,
			upload_progress_handler: uploadProgress,
			upload_error_handler: uploadError,
			upload_success_handler: uploadSuccessForAlbum,
			upload_complete_handler: uploadComplete,
			queue_complete_handler: queueComplete	// Queue plugin event
		};
		swfu = new SWFUpload(settings);
	};
</script>

<div>
	<form id="ajaxUploadForm" action="@Url.RouteUrl("Default", new { controller = "File", action = "SWFUpload"})" method="post" enctype="multipart/form-data">
		<fieldset class="ui-widget ui-widget-content ui-corner-all fieldset" id="fsUploadProgress">
			<div class="ui-helper-margin-top-bottom">
				<span id="spanButtonPlaceHolder"></span>
				<input id="btnUpload" type="button" value="Select Files" style="width: 100px; height: 30px; font-size: 8pt;" />
				<input id="btnCancel" type="button" value="Cancel All Uploads" onclick="swfu.cancelQueue();" disabled="disabled" style="margin-left: 2px; font-size: 8pt; height: 30px;" />
			</div>
		</fieldset>
	</form>
</div>