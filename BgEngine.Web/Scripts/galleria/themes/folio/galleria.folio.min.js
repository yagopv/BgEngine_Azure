/*
 Galleria Folio Theme 2011-06-08
 http://galleria.aino.se

 Copyright (c) 2011, Aino
*/
(function(f){Galleria.addTheme({name:"folio",author:"Galleria",css:"galleria.folio.css",defaults:{transition:"pulse",thumbCrop:"width",imageCrop:!1,carousel:!1,show:!1,easing:"galleriaOut",fullscreenDoubleTap:!1,_webkitCursor:!0,_animate:!0},init:function(b){this.addElement("preloader","loaded","close").append({container:"preloader",preloader:"loaded",stage:"close"});var e=this,p=this.$("stage"),g=this.$("thumbnails"),n=this.$("images"),h=this.$("info"),q=this.$("loader"),l=this.$("target"),
o=0,r=l.width(),m=0,s=b.show,k=!1,t=function(a){e.$("info").css({left:Math.max(20,f(window).width()/2-a/2+10)})},u=function(a,c){var c=f.extend({speed:400,width:190,onbrick:function(){},onheight:function(){},delay:0,debug:!1},c),a=f(a),d=a.children(),b=a.width(),e=Math.floor(b/c.width),j=[],i,g,h,b={"float":"none",position:"absolute",display:f.browser.safari?"inline-block":"block"};if(a.data("colCount")!==e&&(a.data("colCount",e),d.length)){for(i=0;i<e;i++)j[i]=0;a.css("position","relative");d.css(b).each(function(a,
b){b=f(b);for(i=e-1;i>-1;i--)j[i]===Math.min.apply(window,j)&&(g=i);h={top:j[g],left:c.width*g};typeof h.top!=="number"||typeof h.left!=="number"||(c.speed?window.setTimeout(function(a,b,c){return function(){Galleria.utils.animate(a,c,{easing:"galleriaOut",duration:b.speed,complete:b.onbrick})}}(b,c,h),a*c.delay):(b.css(h),c.onbrick.call(b)),b.data("height")||b.data("height",b.outerHeight(!0)),j[g]+=b.data("height"))});d=Math.max.apply(window,j);!(d<0)&&typeof d==="number"&&(c.speed?a.animate({height:Math.max.apply(window,
j)},c.speed,c.onheight):(a.height(Math.max.apply(window,j)),c.onheight.call(a)))}};Galleria.OPERA&&this.$("stage").css("display","none");this.bind("fullscreen_enter",function(){n.css("visibility","hidden");p.show();this.$("container").css("height","100%");k=!0});this.bind("fullscreen_exit",function(){p.hide();g.show();h.hide();k=!1});this.bind("thumbnail",function(a){this.addElement("plus");var c=a.thumbTarget,d=this.$("plus").css({display:"block"}).insertAfter(c),k=f(c).parent().data("index",a.index);
b.showInfo&&this.hasInfo(a.index)&&d.append("<span>"+this.getData(a.index).title+"</span>");m=m||f(c).parent().outerWidth(!0);f(c).css("opacity",0);k.unbind(b.thumbEventType);Galleria.IE?d.hide():d.css("opacity",0);Galleria.TOUCH?k.bind("touchstart",function(){d.css("opacity",1)}).bind("touchend",function(){d.hide()}):k.hover(function(){Galleria.IE?d.show():d.stop().css("opacity",1)},function(){Galleria.IE?d.hide():d.stop().animate({opacity:0},300)});o++;this.$("loaded").css("width",o/this.getDataLength()*
100+"%");o===this.getDataLength()&&(this.$("preloader").fadeOut(100),u(g,{width:m,speed:b._animate?400:0,onbrick:function(){var a=f(this).find("img");window.setTimeout(function(a){return function(){Galleria.utils.animate(a,{opacity:1},{duration:b.transition_speed});a.parent().bind(Galleria.TOUCH?"mouseup":"click",function(){g.hide();h.hide();var a=f(this);e.enterFullscreen(function(){e.show(a.data("index"));a.data("index")===s&&(n.css("visibility","visible"),h.toggle(e.hasInfo()))})})}}(a),b._animate?
a.parent().data("index")*100:0)},onheight:function(){l.height(g.height())}}))});this.bind("loadstart",function(a){a.cached||q.show()});this.bind("loadfinish",function(a){h.hide();s=this.getIndex();n.css("visibility","visible");q.hide();this.hasInfo()&&b.showInfo&&h.fadeIn(b.transition?b.transitionSpeed:0);t(a.imageTarget.width)});Galleria.TOUCH||(this.addIdleState(this.get("image-nav-left"),{left:-100}),this.addIdleState(this.get("image-nav-right"),{right:-100}),this.addIdleState(this.get("info"),
{opacity:0}),this.addIdleState(this.get("close"),{top:-50}));this.$("container").css({width:b.width,height:"auto"});b._webkitCursor&&Galleria.WEBKIT&&this.$("image-nav-right,image-nav-left").addClass("cur");Galleria.TOUCH&&(this.setOptions({transition:"fadeslide",initialTransition:!1}),this.$("image-nav").hide());this.$("close").click(function(){e.exitFullscreen()});f(window).resize(function(){if(k)e.getActiveImage()&&t(e.getActiveImage().width);else{var a=l.width();a!==r&&(r=a,u(g,{width:m,delay:50,
debug:!0,onheight:function(){l.height(g.height())}}))}})}})})(jQuery);